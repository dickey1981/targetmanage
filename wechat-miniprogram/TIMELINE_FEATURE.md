# æ—¶é—´çº¿åŠŸèƒ½å®ç°æ–‡æ¡£

## ğŸ“… åŠŸèƒ½æ¦‚è¿°

æ—¶é—´çº¿é¡µé¢æ˜¯ä¸€ä¸ªå¯è§†åŒ–å±•ç¤ºç”¨æˆ·æ‰€æœ‰è¿‡ç¨‹è®°å½•çš„åŠŸèƒ½ï¼ŒæŒ‰æ—¶é—´é¡ºåºæ’åˆ—ï¼Œæä¾›ç›´è§‚çš„æˆé•¿è½¨è¿¹æŸ¥çœ‹ä½“éªŒã€‚

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. æ•°æ®å±•ç¤º
- **æŒ‰æ—¥æœŸåˆ†ç»„**ï¼šè®°å½•æŒ‰æ—¥æœŸåˆ†ç»„æ˜¾ç¤ºï¼Œæ¯å¤©çš„è®°å½•æ•°é‡ä¸€ç›®äº†ç„¶
- **å·¦ä¾§æ—¶é—´è½´**ï¼šç¾è§‚çš„å‚ç›´æ—¶é—´è½´ï¼Œå¸¦æœ‰æ¸å˜è‰²å’ŒèŠ‚ç‚¹æ ‡è®°
- **è®°å½•å¡ç‰‡**ï¼šæ¯æ¡è®°å½•ä»¥å¡ç‰‡å½¢å¼å±•ç¤ºï¼ŒåŒ…å«ï¼š
  - è®°å½•ç±»å‹å›¾æ ‡å’Œåç§°ï¼ˆè¿›åº¦ã€è¿‡ç¨‹ã€é‡Œç¨‹ç¢‘ç­‰ï¼‰
  - è®°å½•å†…å®¹
  - æ—¶é—´æˆ³ï¼ˆç›¸å¯¹æ—¶é—´ï¼šåˆšåˆšã€Xåˆ†é’Ÿå‰ã€Xå°æ—¶å‰ç­‰ï¼‰
  - æ ‡ç­¾
  - èƒ½é‡ç­‰çº§å’Œéš¾åº¦ç­‰çº§
  - é‡è¦æ ‡è®°ï¼ˆâ­é‡è¦ã€ğŸ†é‡Œç¨‹ç¢‘ã€ğŸ’¡çªç ´ï¼‰

### 2. ç»Ÿè®¡æ¦‚è§ˆ
é¡¶éƒ¨æ˜¾ç¤ºç»Ÿè®¡å¡ç‰‡ï¼ŒåŒ…å«ï¼š
- æ€»è®°å½•æ•°
- é‡Œç¨‹ç¢‘æ•°é‡
- çªç ´æ•°é‡
- ç§¯æç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰

### 3. ç­›é€‰åŠŸèƒ½
- **ç±»å‹ç­›é€‰**ï¼šå…¨éƒ¨ã€è¿›åº¦ã€é‡Œç¨‹ç¢‘ã€å›°éš¾
- **æ—¶é—´èŒƒå›´**ï¼šæœ€è¿‘7å¤©ã€æœ€è¿‘30å¤©ã€æœ€è¿‘90å¤©ã€å…¨éƒ¨

### 4. äº¤äº’åŠŸèƒ½
- **ä¸‹æ‹‰åˆ·æ–°**ï¼šåˆ·æ–°æ—¶é—´çº¿æ•°æ®
- **ä¸Šæ‹‰åŠ è½½**ï¼šè‡ªåŠ¨åŠ è½½æ›´å¤šå†å²è®°å½•
- **ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…**ï¼šç‚¹å‡»è®°å½•å¡ç‰‡è·³è½¬åˆ°è¯¦æƒ…é¡µ
- **ç©ºçŠ¶æ€å¼•å¯¼**ï¼šæ— è®°å½•æ—¶æ˜¾ç¤ºå‹å¥½æç¤ºå’Œ"å»è®°å½•"æŒ‰é’®

---

## ğŸ¨ è§†è§‰è®¾è®¡

### é…è‰²æ–¹æ¡ˆ
- **ä¸»è‰²è°ƒ**ï¼š`#00B4D8` (é’è‰²) â†’ `#0077B6` (æ·±é’è‰²)
- **é‡è¦æ ‡è®°**ï¼š`#ff9800` (æ©™è‰²)
- **é‡Œç¨‹ç¢‘**ï¼š`#4caf50` (ç»¿è‰²)
- **çªç ´**ï¼š`#9c27b0` (ç´«è‰²)

### æ ·å¼ç‰¹ç‚¹
1. **æ¸å˜èƒŒæ™¯**ï¼šç»Ÿè®¡å¡ç‰‡ä½¿ç”¨æ¸å˜èƒŒæ™¯ï¼Œæ›´æœ‰è§†è§‰å†²å‡»åŠ›
2. **æ—¶é—´è½´çº¿**ï¼šå·¦ä¾§å‚ç›´çº¿æ¡ï¼Œå¸¦æ¸å˜è‰²
3. **èŠ‚ç‚¹æ ‡è®°**ï¼šæ¯æ¡è®°å½•åœ¨æ—¶é—´è½´ä¸Šæœ‰åœ†å½¢èŠ‚ç‚¹ï¼Œä¸åŒç±»å‹ä¸åŒé¢œè‰²
4. **å¡ç‰‡é˜´å½±**ï¼šè½»å¾®é˜´å½±æå‡å±‚æ¬¡æ„Ÿ
5. **ç‚¹å‡»åé¦ˆ**ï¼šå¡ç‰‡ç‚¹å‡»æ—¶æœ‰ç¼©æ”¾åŠ¨ç”»

---

## ğŸ”Œ APIæ¥å£

### 1. æ—¶é—´çº¿æ•°æ®æ¥å£
**ç«¯ç‚¹**ï¼š`GET /api/process-records/timeline`

**è¯·æ±‚å‚æ•°**ï¼š
```javascript
{
  days: 7,              // æ—¶é—´èŒƒå›´ï¼ˆå¤©æ•°ï¼‰
  goal_id: null,        // ç›®æ ‡IDï¼ˆå¯é€‰ï¼‰
  record_type: null     // è®°å½•ç±»å‹ï¼ˆå¯é€‰ï¼‰
}
```

**å“åº”æ ¼å¼**ï¼š
```javascript
[
  {
    date: "2025-11-07",           // æ—¥æœŸ
    records: [                     // å½“æ—¥è®°å½•åˆ—è¡¨
      {
        id: "xxx",
        content: "è®°å½•å†…å®¹",
        record_type: "progress",
        recorded_at: "2025-11-07T10:30:00",
        tags: ["æ ‡ç­¾1", "æ ‡ç­¾2"],
        energy_level: 8,
        difficulty_level: 5,
        is_important: true,
        is_milestone: false,
        is_breakthrough: false,
        // ... å…¶ä»–å­—æ®µ
      }
    ],
    milestone_count: 1,            // å½“æ—¥é‡Œç¨‹ç¢‘æ•°
    breakthrough_count: 0          // å½“æ—¥çªç ´æ•°
  }
]
```

### 2. ç»Ÿè®¡æ•°æ®æ¥å£
**ç«¯ç‚¹**ï¼š`GET /api/process-records/stats`

**è¯·æ±‚å‚æ•°**ï¼š
```javascript
{
  days: 7,              // æ—¶é—´èŒƒå›´ï¼ˆå¤©æ•°ï¼‰
  goal_id: null         // ç›®æ ‡IDï¼ˆå¯é€‰ï¼‰
}
```

**å“åº”æ ¼å¼**ï¼š
```javascript
{
  total_records: 25,                    // æ€»è®°å½•æ•°
  records_by_type: {                    // æŒ‰ç±»å‹ç»Ÿè®¡
    "progress": 10,
    "milestone": 3,
    // ...
  },
  records_by_mood: {                    // æŒ‰æƒ…ç»ªç»Ÿè®¡
    "positive": 15,
    "neutral": 8,
    "negative": 2
  },
  milestone_count: 3,                   // é‡Œç¨‹ç¢‘æ•°
  breakthrough_count: 2,                // çªç ´æ•°
  avg_energy_level: 7.5,                // å¹³å‡èƒ½é‡ç­‰çº§
  avg_difficulty_level: 5.2,            // å¹³å‡éš¾åº¦ç­‰çº§
  positive_sentiment_ratio: 0.6         // ç§¯æç‡
}
```

---

## ğŸ“± é¡µé¢ç»“æ„

```
wechat-miniprogram/pages/timeline/
â”œâ”€â”€ timeline.js          # é¡µé¢é€»è¾‘
â”œâ”€â”€ timeline.wxml        # é¡µé¢æ¨¡æ¿
â”œâ”€â”€ timeline.wxss        # é¡µé¢æ ·å¼
â””â”€â”€ timeline.json        # é¡µé¢é…ç½®
```

---

## ğŸ”§ å…³é”®å®ç°

### 1. æ•°æ®é¢„å¤„ç†
åœ¨åŠ è½½æ•°æ®æ—¶ï¼Œå°†è¾…åŠ©æ–¹æ³•çš„ç»“æœé¢„å…ˆè®¡ç®—å¹¶å­˜å…¥æ•°æ®ï¼š

```javascript
const processedData = newData.map(item => {
  return {
    ...item,
    records: item.records.map(record => ({
      ...record,
      typeIcon: this.getTypeIcon(record.record_type),
      typeName: this.getTypeName(record.record_type),
      formattedTime: this.formatTime(record.recorded_at)
    }))
  }
})
```

**åŸå› **ï¼šå¾®ä¿¡å°ç¨‹åºWXMLä¸æ”¯æŒåœ¨æ¨¡æ¿ä¸­ç›´æ¥è°ƒç”¨Pageæ–¹æ³•ã€‚

### 2. ç›¸å¯¹æ—¶é—´æ ¼å¼åŒ–
```javascript
formatTime(timeStr) {
  const date = new Date(timeStr)
  const now = new Date()
  const diff = now - date
  
  if (diff < 60000) return 'åˆšåˆš'
  if (diff < 3600000) return Math.floor(diff / 60000) + 'åˆ†é’Ÿå‰'
  if (diff < 86400000) return Math.floor(diff / 3600000) + 'å°æ—¶å‰'
  if (diff < 604800000) return Math.floor(diff / 86400000) + 'å¤©å‰'
  
  return date.toLocaleDateString()
}
```

### 3. ä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½
```javascript
// ä¸‹æ‹‰åˆ·æ–°
onPullDownRefresh() {
  this.refreshData()
  wx.stopPullDownRefresh()
}

// ä¸Šæ‹‰åŠ è½½æ›´å¤š
onReachBottom() {
  this.loadMore()
}
```

### 4. è®°å½•è¯¦æƒ…è·³è½¬
```javascript
viewRecordDetail(e) {
  const record = e.currentTarget.dataset.record
  wx.navigateTo({
    url: `/pages/record-detail/record-detail?id=${record.id}`
  })
}
```

---

## ğŸ¯ ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### 1. åŠ è½½çŠ¶æ€
- æ•°æ®åŠ è½½æ—¶æ˜¾ç¤ºloadingçŠ¶æ€
- é˜²æ­¢é‡å¤è¯·æ±‚ï¼ˆloadingæ ‡å¿—ä½ï¼‰

### 2. ç©ºçŠ¶æ€
- æ— è®°å½•æ—¶æ˜¾ç¤ºå‹å¥½æç¤º
- æä¾›"å»è®°å½•"æŒ‰é’®å¼•å¯¼ç”¨æˆ·åˆ›å»ºè®°å½•

### 3. è§†è§‰åé¦ˆ
- å¡ç‰‡ç‚¹å‡»æ—¶æœ‰ç¼©æ”¾åŠ¨ç”»
- ç­›é€‰å™¨åˆ‡æ¢æœ‰è¿‡æ¸¡æ•ˆæœ
- é‡è¦è®°å½•æœ‰ç‰¹æ®Šæ ‡è®°å’Œé¢œè‰²

### 4. æ€§èƒ½ä¼˜åŒ–
- åˆ†é¡µåŠ è½½ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®
- æ•°æ®é¢„å¤„ç†ï¼Œå‡å°‘æ¨¡æ¿ä¸­çš„è®¡ç®—

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. è¿›å…¥æ—¶é—´çº¿
ç‚¹å‡»åº•éƒ¨tabBarçš„"æ—¶é—´çº¿"å›¾æ ‡ï¼ˆæ—¶é’Ÿâ°ï¼‰

### 2. ç­›é€‰è®°å½•
- ç‚¹å‡»é¡¶éƒ¨ç±»å‹æ ‡ç­¾ï¼ˆå…¨éƒ¨ã€è¿›åº¦ã€é‡Œç¨‹ç¢‘ã€å›°éš¾ï¼‰
- ç‚¹å‡»æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ï¼ˆæœ€è¿‘7å¤©ã€æœ€è¿‘30å¤©ç­‰ï¼‰

### 3. æŸ¥çœ‹è¯¦æƒ…
ç‚¹å‡»ä»»æ„è®°å½•å¡ç‰‡ï¼Œè·³è½¬åˆ°è¯¦æƒ…é¡µæŸ¥çœ‹å®Œæ•´ä¿¡æ¯

### 4. åˆ·æ–°æ•°æ®
ä¸‹æ‹‰é¡µé¢åˆ·æ–°æœ€æ–°è®°å½•

### 5. åŠ è½½æ›´å¤š
æ»šåŠ¨åˆ°åº•éƒ¨è‡ªåŠ¨åŠ è½½æ›´å¤šå†å²è®°å½•

---

## ğŸ“Š æ•°æ®æµç¨‹

```
ç”¨æˆ·è¿›å…¥é¡µé¢
    â†“
onLoad è§¦å‘
    â†“
loadTimelineData() + loadStats()
    â†“
å‘é€APIè¯·æ±‚ï¼ˆå¸¦tokenï¼‰
    â†“
æ¥æ”¶å“åº”æ•°æ®
    â†“
æ•°æ®é¢„å¤„ç†ï¼ˆæ·»åŠ è¾…åŠ©å­—æ®µï¼‰
    â†“
setData æ›´æ–°é¡µé¢
    â†“
æ¸²æŸ“æ—¶é—´çº¿
```

---

## ğŸ” æƒé™è¦æ±‚

- éœ€è¦ç”¨æˆ·ç™»å½•ï¼ˆtokenè®¤è¯ï¼‰
- åªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®°å½•

---

## ğŸ› å·²çŸ¥é—®é¢˜å’Œæ³¨æ„äº‹é¡¹

1. **WXMLæ–¹æ³•è°ƒç”¨é™åˆ¶**ï¼šä¸èƒ½åœ¨æ¨¡æ¿ä¸­ç›´æ¥è°ƒç”¨Pageæ–¹æ³•ï¼Œéœ€è¦é¢„å¤„ç†æ•°æ®
2. **æ—¶é—´æ ¼å¼**ï¼šåç«¯è¿”å›çš„æ—¶é—´éœ€è¦æ˜¯ISO 8601æ ¼å¼
3. **åˆ†é¡µåŠ è½½**ï¼šç›®å‰åç«¯APIå¯èƒ½ä¸æ”¯æŒåˆ†é¡µå‚æ•°ï¼Œéœ€è¦ç¡®è®¤
4. **å›¾ç‰‡é™„ä»¶**ï¼šå½“å‰ç‰ˆæœ¬æœªæ˜¾ç¤ºå›¾ç‰‡é™„ä»¶ï¼Œåç»­å¯å¢å¼º

---

## ğŸ‰ å®ŒæˆçŠ¶æ€

âœ… é¡µé¢ç»“æ„åˆ›å»º  
âœ… APIè°ƒç”¨å®ç°  
âœ… æ—¶é—´è½´æ ·å¼è®¾è®¡  
âœ… æŒ‰æ—¥æœŸåˆ†ç»„å±•ç¤º  
âœ… ä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½  
âœ… è®°å½•è¯¦æƒ…è·³è½¬  
âœ… ç­›é€‰åŠŸèƒ½  
âœ… ç»Ÿè®¡æ¦‚è§ˆ  
âœ… ç©ºçŠ¶æ€å¤„ç†  

---

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **å›¾ç‰‡å±•ç¤º**ï¼šåœ¨è®°å½•å¡ç‰‡ä¸­æ˜¾ç¤ºå›¾ç‰‡é™„ä»¶ç¼©ç•¥å›¾
2. **æœç´¢åŠŸèƒ½**ï¼šæ·»åŠ å…³é”®è¯æœç´¢
3. **å¯¼å‡ºåŠŸèƒ½**ï¼šæ”¯æŒå¯¼å‡ºæ—¶é—´çº¿ä¸ºPDFæˆ–å›¾ç‰‡
4. **åˆ†äº«åŠŸèƒ½**ï¼šåˆ†äº«å•æ¡è®°å½•æˆ–æ•´ä¸ªæ—¶é—´çº¿
5. **æ•°æ®å¯è§†åŒ–**ï¼šæ·»åŠ å›¾è¡¨å±•ç¤ºç»Ÿè®¡æ•°æ®
6. **ç¦»çº¿ç¼“å­˜**ï¼šç¼“å­˜å·²åŠ è½½çš„æ•°æ®ï¼Œæå‡åŠ è½½é€Ÿåº¦
7. **åŠ¨ç”»ä¼˜åŒ–**ï¼šæ·»åŠ è®°å½•å‡ºç°çš„åŠ¨ç”»æ•ˆæœ
8. **æ‰‹åŠ¿æ“ä½œ**ï¼šæ”¯æŒå·¦æ»‘åˆ é™¤ã€å³æ»‘ç¼–è¾‘ç­‰æ‰‹åŠ¿

---

**å¼€å‘å®Œæˆæ—¶é—´**ï¼š2025-11-07  
**ç‰ˆæœ¬**ï¼šv1.0

