# 目标详情页 (Goal Detail Page)

## 📱 页面功能

目标详情页是一个功能完整的页面，允许用户查看和编辑目标的详细信息。

## 🎯 主要特性

### 1. 查看模式
- **目标基本信息**：标题、分类、描述
- **时间设置**：开始时间、结束时间
- **量化指标**：目标值、当前值、单位
- **进度显示**：基于目标值和当前值自动计算进度百分比
- **优先级设置**：高、中、低（带图标显示）
- **提醒设置**：每日提醒、截止提醒状态
- **创建时间**：显示目标创建的具体时间

### 2. 编辑模式
- **切换编辑**：点击右上角"编辑"按钮进入编辑模式
- **实时编辑**：所有字段都可以直接修改
- **智能保存**：编辑完成后点击"保存修改"按钮
- **数据验证**：必填字段验证，确保数据完整性

### 3. 数据同步
- **自动刷新**：保存成功后自动更新页面显示
- **列表同步**：通知上一页刷新目标列表
- **进度计算**：自动重新计算并显示最新进度

## 🔗 页面跳转

### 进入详情页
```javascript
// 从目标列表页跳转
wx.navigateTo({
  url: `/pages/goal-detail/goal-detail?id=${goalId}`
})
```

### 参数说明
- `id`: 目标ID，必填参数

## 📋 API接口

### 获取目标详情
- **接口**: `GET /api/goals/{goal_id}`
- **认证**: 需要Bearer Token
- **返回**: 目标完整信息

### 更新目标
- **接口**: `PUT /api/goals/{goal_id}`
- **认证**: 需要Bearer Token
- **参数**: 目标更新数据
- **返回**: 更新成功消息

## 🎨 UI组件

### 输入组件
- **文本输入框**: 标题、目标值、当前值、单位
- **多行文本框**: 目标描述
- **日期选择器**: 开始时间、结束时间
- **分类选择器**: 下拉选择目标分类
- **优先级选择**: 三个选项卡片（高、中、低）
- **开关组件**: 提醒设置开关

### 显示组件
- **进度条**: 可视化显示目标完成进度
- **状态标签**: 显示优先级、分类等信息
- **信息卡片**: 白色背景的信息展示区域

## 🔧 技术实现

### 状态管理
```javascript
data: {
  goalId: '',           // 目标ID
  goalData: {},         // 目标数据
  isEditing: false,     // 编辑模式状态
  categories: [],       // 分类选项
  categoryIndex: 0,     // 当前分类索引
  progressPercentage: 0 // 进度百分比
}
```

### 核心函数
- `loadGoalDetail()`: 加载目标详情
- `toggleEditMode()`: 切换编辑模式
- `saveChanges()`: 保存修改
- `calculateProgress()`: 计算进度
- `findCategoryIndex()`: 查找分类索引

### 数据流
1. **页面加载** → 获取目标ID → 调用API加载详情
2. **编辑模式** → 用户修改数据 → 实时更新本地状态
3. **保存数据** → 调用更新API → 更新本地数据 → 通知上一页刷新

## 🚀 使用方法

### 1. 查看目标详情
- 在目标列表页点击任意目标卡片
- 系统自动跳转到目标详情页
- 显示目标的所有信息

### 2. 编辑目标信息
- 点击右上角"编辑"按钮
- 修改需要更新的字段
- 点击"保存修改"按钮
- 系统自动保存并更新显示

### 3. 返回列表
- 点击左上角返回按钮
- 目标列表页自动刷新显示最新数据

## 🐛 常见问题

### Q: 页面显示"API地址未配置"？
A: 检查 `app.js` 中的 `baseUrl` 配置是否正确

### Q: 编辑后保存失败？
A: 检查网络连接和用户登录状态

### Q: 进度条不显示？
A: 确保目标值和当前值都已设置

## 📝 更新日志

- **v1.0.0**: 初始版本，支持查看和编辑目标详情
- **v1.0.1**: 修复API URL配置问题
- **v1.0.2**: 添加调试信息和错误处理
- **v1.0.3**: 优化数据同步和页面刷新逻辑
